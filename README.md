haskell the code from the [sphinx package](hackage.haskell.org/package/sphinx)
with a few minor improvements and advanced features added
